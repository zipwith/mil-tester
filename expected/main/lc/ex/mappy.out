data List (a :: *)
  = Nil
  | Cons a (List a)

-----------------------------------------
-- not recursive
entrypoint size :: Word
size <-
  return 4

-----------------------------------------
-- not recursive
Nil :: forall (a :: *). List a
Nil <-
  Nil()

-----------------------------------------
-- not recursive
s8 :: List Word
s8 <-
  Cons(16, Nil)

-----------------------------------------
-- not recursive
s9 :: List Word
s9 <-
  Cons(9, s8)

-----------------------------------------
-- not recursive
s10 :: List Word
s10 <-
  Cons(4, s9)

-----------------------------------------
-- not recursive
entrypoint main :: List Word
main <-
  Cons(1, s10)

-----------------------------------------
-- not recursive
b79 :: [Word] >>= [Word]
b79[t0] =
  return t0

-----------------------------------------
-- recursive
b95 :: forall (a :: *). [List a, Word] >>= [Word]
b95[t0, t1] =
  assert t0 Cons
  t2 <- Cons 1 t0
  t3 <- add((t1, 1))
  case t2 of
    Nil -> b79[t3]
    Cons -> b95[t2, t3]

-----------------------------------------
-- not recursive
b80 :: forall (a :: *). [List a, Word] >>= [Word]
b80[t0, t1] =
  case t0 of
    Nil -> b79[t1]
    Cons -> b95[t0, t1]

-----------------------------------------
-- not recursive
k52 :: forall (a :: *). {Word} [List a] ->> [Word]
k52{t0} t1 = b80[t1, t0]

-----------------------------------------
-- not recursive
entrypoint length :: forall (a :: *). [List a] ->> [Word]
length <-
  k52{0}

-----------------------------------------
-- not recursive
b85 :: forall (a :: *). [] >>= [List a]
b85[] =
  return Nil

-----------------------------------------
-- recursive
b96 :: forall (a :: *) (a0 :: *). [List a, [a] ->> [a0]] >>= [List a0]
b96[t0, t1] =
  assert t0 Cons
  t2 <- Cons 0 t0
  t3 <- Cons 1 t0
  t4 <- t1 @ t2
  t5 <- b86[t3, t1]
  Cons(t4, t5)
b86 :: forall (a :: *) (a0 :: *). [List a, [a] ->> [a0]] >>= [List a0]
b86[t0, t1] =
  case t0 of
    Nil -> b85[]
    Cons -> b96[t0, t1]

-----------------------------------------
-- not recursive
k54 :: forall (a :: *) (a0 :: *). {[a] ->> [a0]} [List a] ->> [List a0]
k54{t0} t1 = b86[t1, t0]

-----------------------------------------
-- not recursive
k55 :: forall (a :: *) (a0 :: *). {} [[a] ->> [a0]] ->> [[List a] ->> [List a0]]
k55{} t0 = k54{t0}

-----------------------------------------
-- not recursive
entrypoint map :: forall (a :: *) (a0 :: *). [[a] ->> [a0]] ->> [[List a] ->> [List a0]]
map <-
  k55{}

-----------------------------------------
-- Entrypoints: size main length map
