data Pair2
  = Pair4 Tree1 Word

data Tree0
  = Leaf0
  | Node1 Tree0 Flag Tree0

data Tree1
  = Leaf2
  | Node3 Tree1 Word Tree1

-----------------------------------------
-- not recursive
Leaf :: Tree1
Leaf <-
  Leaf2()

-----------------------------------------
-- not recursive
s3 :: Pair2
s3 <-
  Pair4(Leaf, 0)

-----------------------------------------
-- not recursive
b135 :: [] >>= [Pair2]
b135[] =
  return s3

-----------------------------------------
-- not recursive
b129 :: [Word] >>= [Pair2]
b129[t0] =
  Pair4(Leaf, t0)

-----------------------------------------
-- recursive
b143 :: [Tree0, Word] >>= [Pair2]
b143[t0, t1] =
  assert t0 Node1
  t2 <- Node1 0 t0
  t3 <- Node1 2 t0
  t4 <- b128[t2, t1]
  t5 <- Pair4 0 t4
  t6 <- Pair4 1 t4
  t7 <- add((t6, 1))
  t8 <- b128[t3, t7]
  t9 <- Pair4 0 t8
  t10 <- Node3(t5, t6, t9)
  t11 <- Pair4 1 t8
  Pair4(t10, t11)
b128 :: [Tree0, Word] >>= [Pair2]
b128[t0, t1] =
  case t0 of
    Leaf0 -> b129[t1]
    Node1 -> b143[t0, t1]

-----------------------------------------
-- recursive
b144 :: [Tree0] >>= [Pair2]
b144[t0] =
  assert t0 Node1
  t1 <- Node1 0 t0
  t2 <- Node1 2 t0
  t3 <- main[t1]
  t4 <- Pair4 0 t3
  t5 <- Pair4 1 t3
  t6 <- add((t5, 1))
  t7 <- b128[t2, t6]
  t8 <- Pair4 0 t7
  t9 <- Node3(t4, t5, t8)
  t10 <- Pair4 1 t7
  Pair4(t9, t10)
entrypoint main :: [Tree0] >>= [Pair2]
main[t0] =
  case t0 of
    Leaf0 -> b135[]
    Node1 -> b144[t0]

-----------------------------------------
-- Entrypoints: main
