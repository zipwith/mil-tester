bitdata Bool /1
  = False [ B0 ]
    -- predFalse(x :: Bit 1) = x == 0x0
  | True [ B1 ]
    -- predTrue(x :: Bit 1) = x == 0x1

-- bit pattern:
--  _

struct Context / 72
  [ regs :: Registers  {- offset=0 -}
  | segregs :: SegRegs  {- offset=32 -}
  | iframe :: IFrame  {- offset=48 -} ]
  aligned 4

struct Coord / 2
  [ row :: Stored (Ix 25)  {- offset=0 -}
  | col :: Stored (Ix 80)  {- offset=1 -} ]
  aligned 1

bitdata IA32Flags /32
  = IA32Flags [ B00_0000_0000 | id :: Bit 1 | vip :: Bit 1 | vif :: Bit 1 | ac :: Bit 1 | vm :: Bit 1 | rf :: Bit 1 | B0 | nt :: Bit 1 | iopl :: Ix 4 | ovf :: Bit 1 | df :: Bit 1 | ifl :: Bit 1 | tf :: Bit 1 | sf :: Bit 1 | zf :: Bit 1 | B0 | af :: Bit 1 | B0 | pf :: Bit 1 | B1 | cf :: Bit 1 ]
    -- predIA32Flags(x :: Bit 32) = true

-- bit pattern:
--  0000000000______0_________0_0_1_

struct IFrame / 24
  [ err :: Stored (Bit 32)  {- offset=0 -}
  | eip :: Stored (Bit 32)  {- offset=4 -}
  | cs :: Stored SegSelector  {- offset=8 -}
  | eflags :: Stored IA32Flags  {- offset=12 -}
  | esp :: Stored (Bit 32)  {- offset=16 -}
  | ss :: Stored SegSelector  {- offset=20 -} ]
  aligned 4

data Maybe1142834
  = Nothing1234656
  | Just2244757 Pair0152935

data Pair0152935
  = Pair0254858 (Bit 32) (Bit 32) (Bit 32)

struct Registers / 32
  [ edi :: Stored (Bit 32)  {- offset=0 -}
  | esi :: Stored (Bit 32)  {- offset=4 -}
  | ebp :: Stored (Bit 32)  {- offset=8 -}
  | esp :: Stored (Bit 32)  {- offset=12 -}
  | ebx :: Stored (Bit 32)  {- offset=16 -}
  | edx :: Stored (Bit 32)  {- offset=20 -}
  | ecx :: Stored (Bit 32)  {- offset=24 -}
  | eax :: Stored (Bit 32)  {- offset=28 -} ]
  aligned 4

struct SegRegs / 16
  [ ds :: Stored SegSelector  {- offset=0 -}
  | es :: Stored SegSelector  {- offset=4 -}
  | fs :: Stored SegSelector  {- offset=8 -}
  | gs :: Stored SegSelector  {- offset=12 -} ]
  aligned 4

bitdata SegSelector /32
  = SegSelector [ X0000 | index :: Ix 8192 | table :: Bit 1 | rpl :: Ix 4 ]
    -- predSegSelector(x :: Bit 32) = true

-- bit pattern:
--  0000000000000000________________

data Unit
  = Unit

struct Window / 7
  [ topleft :: Coord  {- offset=0 -}
  | bottomright :: Coord  {- offset=2 -}
  | current :: Coord  {- offset=4 -}
  | attr :: Stored (Bit 8)  {- offset=6 -} ]
  aligned 8

-----------------------------------------
-- not recursive
current :: Bit 32
current <- area (Stored (Ix 2)) aligned 1

-----------------------------------------
-- not recursive
users :: Bit 32
users <- area (Array 2 Context) aligned 4

-----------------------------------------
-- not recursive
b974 :: [] >>= [Unit]
b974[] =
  t0 <- load1((current))
  t1 <- flagToWord((t0))
  t2 <- mul((t1, 72))
  t3 <- add((users, t2))
  returnTo((t3))

-----------------------------------------
-- not recursive
entrypoint yield :: [] >>= [Unit]
yield[] =
  b974[]

-----------------------------------------
-- not recursive
b1477 :: [Bit 32] >>= [Unit]
b1477[t0] =
  outb((1016, t0))

-----------------------------------------
-- recursive
b263 :: [Bit 32] >>= [Unit]
b263[t0] =
  t1 <- inb((1021))
  t2 <- and((t1, 96))
  t3 <- primEq((t2, 0))
  if t3
    then b263[t0]
    else b1477[t0]

-----------------------------------------
-- not recursive
Unit :: Unit
Unit <-
  Unit()

-----------------------------------------
-- not recursive
b300 :: [] >>= [Unit]
b300[] =
  return Unit

-----------------------------------------
-- recursive
b1054 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1054[t0, t1, t2, t3] =
  t4 <- mul((t3, 160))
  t5 <- mul((t0, 2))
  t6 <- add((t4, t5))
  t7 <- add((t6, 753664))
  t8 <- shl((t2, 8))
  t9 <- or((t8, 32))
  t10 <- store16((t7, t9))
  t11 <- add((t0, 1))
  t12 <- primUle((t11, t1))
  if t12
    then b1054[t11, t1, t2, t3]
    else b300[]

-----------------------------------------
-- recursive
b1057 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1057[t0, t1, t2, t3] =
  t4 <- mul((t3, 160))
  t5 <- mul((t0, 2))
  t6 <- add((t4, t5))
  t7 <- add((t6, 753664))
  t8 <- mul((t2, 160))
  t9 <- add((t8, t5))
  t10 <- add((t9, 753664))
  t11 <- load16((t7))
  t12 <- store16((t10, t11))
  t13 <- add((t0, 1))
  t14 <- primUle((t13, t1))
  if t14
    then b1057[t13, t1, t2, t3]
    else b300[]

-----------------------------------------
-- recursive
b1654 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1654[t0, t1, t2, t3, t4, t5] =
  t6 <- b1057[t4, t3, t1, t0]
  t7 <- add((t0, 1))
  t8 <- primUle((t7, t2))
  if t8
    then b1654[t7, t0, t2, t3, t4, t5]
    else b1054[t4, t3, t5, t2]

-----------------------------------------
-- not recursive
b374 :: [Bit 32] >>= [Unit]
b374[t0] =
  t1 <- load8((t0))
  t2 <- add((t0, 1))
  t3 <- load8((t2))
  t4 <- add((t0, 2))
  t5 <- load8((t4))
  t6 <- add((t0, 3))
  t7 <- load8((t6))
  t8 <- add((t0, 6))
  t9 <- load8((t8))
  t10 <- add((t1, 1))
  t11 <- primUle((t10, t5))
  if t11
    then b1654[t10, t1, t5, t7, t3, t9]
    else b1054[t3, t7, t9, t5]

-----------------------------------------
-- not recursive
b1663 :: [Bit 32, Bit 32] >>= [Unit]
b1663[t0, t1] =
  t2 <- add((t1, 4))
  store8((t2, t0))

-----------------------------------------
-- not recursive
b363 :: [Bit 32, Bit 32] >>= [Unit]
b363[t0, t1] =
  t2 <- add((t1, 1))
  t3 <- add((t1, 5))
  t4 <- load8((t2))
  t5 <- store8((t3, t4))
  t6 <- add((t1, 2))
  t7 <- load8((t6))
  t8 <- add((t0, 1))
  t9 <- primUle((t8, t7))
  if t9
    then b1663[t8, t1]
    else b374[t1]

-----------------------------------------
-- not recursive
b1667 :: [Bit 32, Bit 32] >>= [Unit]
b1667[t0, t1] =
  t2 <- add((t1, 5))
  store8((t2, t0))

-----------------------------------------
-- not recursive
b351 :: [Bit 32, Bit 32, Bit 32] >>= [Unit]
b351[t0, t1, t2] =
  t3 <- add((t1, 5))
  t4 <- load8((t3))
  t5 <- add((t1, 6))
  t6 <- load8((t5))
  t7 <- mul((t2, 160))
  t8 <- mul((t4, 2))
  t9 <- add((t7, t8))
  t10 <- add((t9, 753664))
  t11 <- and((t0, 255))
  t12 <- shl((t6, 8))
  t13 <- or((t11, t12))
  t14 <- store16((t10, t13))
  t15 <- add((t1, 3))
  t16 <- load8((t15))
  t17 <- add((t4, 1))
  t18 <- primUle((t17, t16))
  if t18
    then b1667[t17, t1]
    else b363[t2, t1]

-----------------------------------------
-- not recursive
b354 :: [Bit 32, Bit 32, Bit 32] >>= [Unit]
b354[t0, t1, t2] =
  t3 <- primEq((t2, 10))
  if t3
    then b363[t0, t1]
    else b351[t2, t1, t0]

-----------------------------------------
-- not recursive
b1113 :: [Bit 32, Bit 32] >>= [Unit]
b1113[t0, t1] =
  t2 <- add((t1, 4))
  t3 <- load8((t2))
  t4 <- primEq((t0, 13))
  if t4
    then b363[t3, t1]
    else b354[t3, t1, t0]

-----------------------------------------
-- not recursive
b1133 :: [Bit 32, Bit 32] >>= [Unit]
b1133[t0, t1] =
  t2 <- b263[13]
  t3 <- add((t1, 4))
  t4 <- load8((t3))
  t5 <- primEq((t0, 13))
  if t5
    then b363[t4, t1]
    else b354[t4, t1, t0]

-----------------------------------------
-- not recursive
b1135 :: [Bit 32, Bit 32] >>= [Unit]
b1135[t0, t1] =
  t2 <- b263[t0]
  t3 <- primEq((t0, 10))
  if t3
    then b1133[t0, t1]
    else b1113[t0, t1]

-----------------------------------------
-- not recursive
console :: Bit 32
console <- area Window aligned 8

-----------------------------------------
-- not recursive
entrypoint kputc :: [] >>= [Unit]
kputc[] =
  t0 <- load1((current))
  t1 <- flagToWord((t0))
  t2 <- mul((t1, 72))
  t3 <- add((users, t2))
  t4 <- add((t3, 28))
  t5 <- load32((t4))
  t6 <- b1135[t5, console]
  returnTo((t3))

-----------------------------------------
-- not recursive
ticks :: Bit 32
ticks <- area (Stored (Bit 32)) aligned 4

-----------------------------------------
-- not recursive
b889 :: [Bit 32] >>= [Bit 32]
b889[t0] =
  t1 <- add((t0, 87))
  and((t1, 255))

-----------------------------------------
-- not recursive
b888 :: [Bit 32] >>= [Bit 32]
b888[t0] =
  t1 <- add((t0, 48))
  and((t1, 255))

-----------------------------------------
-- not recursive
b237 :: [Bit 32] >>= [Bit 32]
b237[t0] =
  t1 <- primUle((t0, 9))
  if t1
    then b888[t0]
    else b889[t0]

-----------------------------------------
-- not recursive
spinner :: Bit 32
spinner <- area (Array 4 (Stored (Bit 8))) aligned 1

-----------------------------------------
-- not recursive
spinpos :: Bit 32
spinpos <- area (Stored (Ix 4)) aligned 1

-----------------------------------------
-- not recursive
b1175 :: [] >>= [Unit]
b1175[] =
  t0 <- load8((spinpos))
  t1 <- add((spinner, t0))
  t2 <- load8((t1))
  t3 <- add((t0, 1))
  t4 <- and((t3, 3))
  t5 <- store8((spinpos, t4))
  t6 <- load16((753822))
  t7 <- and((t6, 65280))
  t8 <- or((t7, t2))
  t9 <- store16((753822, t8))
  t10 <- load1((current))
  t11 <- flagToWord((t10))
  t12 <- mul((t11, 72))
  t13 <- add((users, t12))
  returnTo((t13))

-----------------------------------------
-- not recursive
b1699 :: [] >>= [Unit]
b1699[] =
  t0 <- store1((current, flag0))
  b1175[]

-----------------------------------------
-- not recursive
b1697 :: [Bit 32] >>= [Unit]
b1697[t0] =
  t1 <- wordToFlag((t0))
  t2 <- store1((current, t1))
  b1175[]

-----------------------------------------
-- not recursive
b857 :: [] >>= [Unit]
b857[] =
  t0 <- load1((current))
  t1 <- flagToWord((t0))
  t2 <- add((t1, 1))
  t3 <- primUle((t2, 1))
  if t3
    then b1697[t2]
    else b1699[]

-----------------------------------------
-- not recursive
b859 :: [Bit 32] >>= [Unit]
b859[t0] =
  t1 <- and((t0, 15))
  t2 <- primEq((t1, 0))
  if t2
    then b857[]
    else b974[]

-----------------------------------------
-- not recursive
pos :: Bit 32
pos <- area (Stored (Ix 80)) aligned 1

-----------------------------------------
-- not recursive
b822 :: [Bit 32, Bit 32] >>= [Unit]
b822[t0, t1] =
  t2 <- mul((t0, 2))
  t3 <- add((t2, 753664))
  t4 <- load16((t3))
  t5 <- and((t1, 255))
  t6 <- and((t4, 65280))
  t7 <- or((t6, t5))
  store16((t3, t7))

-----------------------------------------
-- not recursive
dir :: Bit 32
dir <- area (Stored Bool) aligned 1

-----------------------------------------
-- not recursive
b1091 :: [Bit 32, Bit 32] >>= [Unit]
b1091[t0, t1] =
  t2 <- b822[t0, 124]
  t3 <- store1((dir, flag1))
  t4 <- and((t1, 15))
  t5 <- primEq((t4, 0))
  if t5
    then b857[]
    else b974[]

-----------------------------------------
-- not recursive
b1702 :: [Bit 32, Bit 32] >>= [Unit]
b1702[t0, t1] =
  t2 <- b822[t0, 60]
  t3 <- store8((pos, t0))
  t4 <- and((t1, 15))
  t5 <- primEq((t4, 0))
  if t5
    then b857[]
    else b974[]

-----------------------------------------
-- not recursive
b1704 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1704[t0, t1, t2, t3] =
  t4 <- sub((t2, t0))
  t5 <- primSle((t1, t4))
  if t5
    then b1702[t4, t3]
    else b1091[t2, t3]

-----------------------------------------
-- not recursive
b1088 :: [Bit 32, Bit 32] >>= [Unit]
b1088[t0, t1] =
  t2 <- b822[t0, 124]
  t3 <- store1((dir, flag0))
  t4 <- and((t1, 15))
  t5 <- primEq((t4, 0))
  if t5
    then b857[]
    else b974[]

-----------------------------------------
-- not recursive
b1707 :: [Bit 32, Bit 32] >>= [Unit]
b1707[t0, t1] =
  t2 <- b822[t0, 62]
  t3 <- store8((pos, t0))
  t4 <- and((t1, 15))
  t5 <- primEq((t4, 0))
  if t5
    then b857[]
    else b974[]

-----------------------------------------
-- not recursive
b1709 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1709[t0, t1, t2, t3] =
  t4 <- add((t1, t0))
  t5 <- primUle((t4, t2))
  if t5
    then b1707[t4, t3]
    else b1088[t1, t3]

-----------------------------------------
-- not recursive
b1085 :: [Bit 32] >>= [Unit]
b1085[t0] =
  t1 <- load8((pos))
  t2 <- b822[t1, 32]
  t3 <- load1((dir))
  if t3
    then b1709[1, t1, 68, t0]
    else b1704[1, 46, t1, t0]

-----------------------------------------
-- not recursive
b1179 :: [Bit 32] >>= [Unit]
b1179[t0] =
  t1 <- and((t0, 3))
  t2 <- primEq((t1, 0))
  if t2
    then b1085[t0]
    else b859[t0]

-----------------------------------------
-- recursive
b1712 :: [Bit 32, Bit 32, Bit 32] >>= [Unit]
b1712[t0, t1, t2] =
  t3 <- lshr((t1, 4))
  t4 <- mul((t0, 2))
  t5 <- add((t4, 753664))
  t6 <- load16((t5))
  t7 <- and((t3, 15))
  t8 <- b237[t7]
  t9 <- and((t6, 65280))
  t10 <- or((t9, t8))
  t11 <- store16((t5, t10))
  t12 <- add((t0, -1))
  t13 <- primSle((70, t12))
  if t13
    then b1712[t12, t3, t2]
    else b1179[t2]

-----------------------------------------
-- not recursive
entrypoint timerInterrupt :: [] >>= [Unit]
timerInterrupt[] =
  t0 <- inb((33))
  t1 <- or((t0, 1))
  t2 <- outb((33, t1))
  t3 <- outb((32, 96))
  t4 <- inb((33))
  t5 <- and((t4, -2))
  t6 <- outb((33, t5))
  t7 <- load32((ticks))
  t8 <- add((t7, 1))
  t9 <- store32((ticks, t8))
  t10 <- load16((753818))
  t11 <- and((t7, 15))
  t12 <- b237[t11]
  t13 <- and((t10, 65280))
  t14 <- or((t13, t12))
  t15 <- store16((753818, t14))
  t16 <- lshr((t7, 4))
  t17 <- load16((753816))
  t18 <- and((t16, 15))
  t19 <- b237[t18]
  t20 <- and((t17, 65280))
  t21 <- or((t20, t19))
  t22 <- store16((753816, t21))
  b1712[75, t16, t7]

-----------------------------------------
-- not recursive
str10 :: Bit 32
str10 <- "Exception 0x"

-----------------------------------------
-- recursive
b1521 :: [Bit 32, Bit 32, Bit 32] >>= [Unit]
b1521[t0, t1, t2] =
  t3 <- add((t1, 1))
  t4 <- b1135[t0, t2]
  t5 <- load8((t3))
  t6 <- primEq((t5, 0))
  if t6
    then b300[]
    else b1521[t5, t3, t2]

-----------------------------------------
-- not recursive
b1519 :: [Bit 32, Bit 32] >>= [Unit]
b1519[t0, t1] =
  t2 <- load8((t0))
  t3 <- primEq((t2, 0))
  if t3
    then b300[]
    else b1521[t2, t0, t1]

-----------------------------------------
-- not recursive
str11 :: Bit 32
str11 <- ", frame=0x"

-----------------------------------------
-- not recursive
itoaBuf :: Bit 32
itoaBuf <- area (Array 32 (Stored (Bit 8))) aligned 1

-----------------------------------------
-- not recursive
b1240 :: [Bit 32] >>= [Unit]
b1240[t0] =
  t1 <- load8((itoaBuf))
  t2 <- b1135[t1, t0]
  return Unit

-----------------------------------------
-- recursive
b1678 :: [Bit 32, Bit 32, Bit 32] >>= [Unit]
b1678[t0, t1, t2] =
  t3 <- b1135[t1, t2]
  t4 <- add((t0, 1))
  t5 <- primUle((t4, 0))
  if t5
    then b1678[t4, t1, t2]
    else b300[]

-----------------------------------------
-- not recursive
b1676 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1676[t0, t1, t2, t3, t4] =
  t5 <- add((t1, t0))
  t6 <- primUle((t5, t2))
  if t6
    then b1678[t5, t4, t3]
    else b300[]

-----------------------------------------
-- not recursive
b1685 :: [Bit 32, Bit 32, Bit 32] >>= [Unit]
b1685[t0, t1, t2] =
  t3 <- b1135[t1, t2]
  t4 <- b1676[1, t0, 0, t2, t1]
  t5 <- load8((itoaBuf))
  t6 <- b1135[t5, t2]
  return Unit

-----------------------------------------
-- not recursive
b1683 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1683[t0, t1, t2, t3] =
  t4 <- add((t1, t0))
  t5 <- primUle((t4, t1))
  if t5
    then b1685[t4, t2, t3]
    else b1240[t3]

-----------------------------------------
-- recursive
b1227 :: [Bit 32, Bit 32] >>= [Unit]
b1227[t0, t1] =
  t2 <- add((itoaBuf, t0))
  t3 <- load8((t2))
  t4 <- b1135[t3, t1]
  t5 <- add((t0, -1))
  t6 <- primSle((0, t5))
  if t6
    then b1227[t5, t1]
    else b300[]

-----------------------------------------
-- not recursive
b1230 :: [Bit 32, Bit 32, Bit 32] >>= [Unit]
b1230[t0, t1, t2] =
  t3 <- b1676[1, t2, 0, t1, t0]
  b1227[t2, t1]

-----------------------------------------
-- recursive
b1689 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1689[t0, t1, t2, t3, t4] =
  t5 <- lshr((t1, 4))
  t6 <- primEq((t5, 0))
  if t6
    then b1230[t4, t3, t2]
    else b1229[t5, t0, t3, t4]
b1229 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1229[t0, t1, t2, t3] =
  t4 <- add((itoaBuf, t1))
  t5 <- and((t0, 15))
  t6 <- b237[t5]
  t7 <- store8((t4, t6))
  t8 <- add((t1, 1))
  t9 <- primUle((t8, 31))
  if t9
    then b1689[t8, t0, t1, t2, t3]
    else b1230[t3, t2, t1]

-----------------------------------------
-- not recursive
b1694 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1694[t0, t1, t2, t3] =
  t4 <- lshr((t1, 4))
  t5 <- primEq((t4, 0))
  if t5
    then b1683[1, 0, t3, t2]
    else b1229[t4, t0, t2, t3]

-----------------------------------------
-- not recursive
b1692 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1692[t0, t1, t2, t3, t4, t5] =
  t6 <- add((t1, t0))
  t7 <- primUle((t6, t2))
  if t7
    then b1694[t6, t3, t4, t5]
    else b1683[1, 0, t5, t4]

-----------------------------------------
-- not recursive
str12 :: Bit 32
str12 <- "\n"

-----------------------------------------
-- not recursive
entrypoint unhandled :: [Bit 32, Bit 32] >>= [Unit]
unhandled[t0, t1] =
  t2 <- b1519[str10, console]
  t3 <- and((t0, 15))
  t4 <- b237[t3]
  t5 <- store8((itoaBuf, t4))
  t6 <- b1692[1, 0, 31, t0, console, 32]
  t7 <- b1519[str11, console]
  t8 <- and((t1, 15))
  t9 <- b237[t8]
  t10 <- store8((itoaBuf, t9))
  t11 <- b1692[1, 0, 31, t1, console, 32]
  t12 <- load8((str12))
  t13 <- primEq((t12, 0))
  if t13
    then b300[]
    else b1521[t12, str12, console]

-----------------------------------------
-- not recursive
s207 :: Unit
s207 <-
  Unit()

-----------------------------------------
-- not recursive
b1310 :: [] >>= [Unit]
b1310[] =
  return s207

-----------------------------------------
-- recursive
b1468 :: [Bit 32, Bit 32] >>= [Unit]
b1468[t0, t1] =
  t2 <- store8((t0, 0))
  t3 <- add((t1, 1))
  t4 <- add((t0, 1))
  b1467[t4, t3]
b1467 :: [Bit 32, Bit 32] >>= [Unit]
b1467[t0, t1] =
  t2 <- primUlt((t1, 32))
  if t2
    then b1468[t0, t1]
    else b1310[]

-----------------------------------------
-- not recursive
str0 :: Bit 32
str0 <- " Context switching kernel has booted!"

-----------------------------------------
-- recursive
b1093 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1093[t0, t1, t2, t3] =
  t4 <- mul((t3, 160))
  t5 <- mul((t0, 2))
  t6 <- add((t4, t5))
  t7 <- add((t6, 753664))
  t8 <- shl((t2, 8))
  t9 <- or((t8, 32))
  t10 <- store16((t7, t9))
  t11 <- add((t0, 1))
  t12 <- primUle((t11, t1))
  if t12
    then b1093[t11, t1, t2, t3]
    else b300[]

-----------------------------------------
-- recursive
b1095 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1095[t0, t1, t2, t3, t4] =
  t5 <- b1093[t4, t3, t2, t0]
  t6 <- add((t0, 1))
  t7 <- primUle((t6, t1))
  if t7
    then b1095[t6, t1, t2, t3, t4]
    else b300[]

-----------------------------------------
-- not recursive
str46 :: Bit 32
str46 <- "Headers:\n"

-----------------------------------------
-- not recursive
str36 :: Bit 32
str36 <- " "

-----------------------------------------
-- not recursive
str37 :: Bit 32
str37 <- "["

-----------------------------------------
-- recursive
b1736 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1736[t0, t1, t2, t3, t4] =
  t5 <- nzdiv((t1, 10))
  t6 <- primEq((t5, 0))
  if t6
    then b1230[t4, t3, t2]
    else b1236[t5, t0, t3, t4]
b1236 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1236[t0, t1, t2, t3] =
  t4 <- add((itoaBuf, t1))
  t5 <- nzrem((t0, 10))
  t6 <- b237[t5]
  t7 <- store8((t4, t6))
  t8 <- add((t1, 1))
  t9 <- primUle((t8, 31))
  if t9
    then b1736[t8, t0, t1, t2, t3]
    else b1230[t3, t2, t1]

-----------------------------------------
-- not recursive
b1741 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1741[t0, t1, t2, t3] =
  t4 <- nzdiv((t1, 10))
  t5 <- primEq((t4, 0))
  if t5
    then b1683[1, 0, t3, t2]
    else b1236[t4, t0, t2, t3]

-----------------------------------------
-- not recursive
b1739 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1739[t0, t1, t2, t3, t4, t5] =
  t6 <- add((t1, t0))
  t7 <- primUle((t6, t2))
  if t7
    then b1741[t6, t3, t4, t5]
    else b1683[1, 0, t5, t4]

-----------------------------------------
-- not recursive
str38 :: Bit 32
str38 <- "]: "

-----------------------------------------
-- not recursive
str40 :: Bit 32
str40 <- "[0x"

-----------------------------------------
-- not recursive
str41 :: Bit 32
str41 <- "-0x"

-----------------------------------------
-- not recursive
str42 :: Bit 32
str42 <- "], entry 0x"

-----------------------------------------
-- not recursive
b465 :: [Bit 32] >>= [Unit]
b465[t0] =
  t1 <- b1519[str40, console]
  t2 <- load32((t0))
  t3 <- and((t2, 15))
  t4 <- b237[t3]
  t5 <- store8((itoaBuf, t4))
  t6 <- b1692[1, 0, 31, t2, console, 32]
  t7 <- b1519[str41, console]
  t8 <- add((t0, 4))
  t9 <- load32((t8))
  t10 <- and((t9, 15))
  t11 <- b237[t10]
  t12 <- store8((itoaBuf, t11))
  t13 <- b1692[1, 0, 31, t9, console, 32]
  t14 <- b1519[str42, console]
  t15 <- add((t0, 8))
  t16 <- load32((t15))
  t17 <- and((t16, 15))
  t18 <- b237[t17]
  t19 <- store8((itoaBuf, t18))
  t20 <- lshr((t16, 4))
  t21 <- primEq((t20, 0))
  if t21
    then b1683[1, 0, 32, console]
    else b1229[t20, 1, console, 32]

-----------------------------------------
-- not recursive
str39 :: Bit 32
str39 <- "\n"

-----------------------------------------
-- not recursive
str48 :: Bit 32
str48 <- "Memory map:\n"

-----------------------------------------
-- not recursive
str43 :: Bit 32
str43 <- "[0x"

-----------------------------------------
-- not recursive
str44 :: Bit 32
str44 <- "-0x"

-----------------------------------------
-- not recursive
str45 :: Bit 32
str45 <- "]"

-----------------------------------------
-- not recursive
str50 :: Bit 32
str50 <- "Strings:\n"

-----------------------------------------
-- not recursive
str51 :: Bit 32
str51 <- "cmdline"

-----------------------------------------
-- not recursive
str53 :: Bit 32
str53 <- " "

-----------------------------------------
-- not recursive
str52 :: Bit 32
str52 <- "imgline"

-----------------------------------------
-- not recursive
str54 :: Bit 32
str54 <- ": "

-----------------------------------------
-- not recursive
str55 :: Bit 32
str55 <- " ["

-----------------------------------------
-- not recursive
str56 :: Bit 32
str56 <- "]\n"

-----------------------------------------
-- not recursive
s31 :: Maybe1142834
s31 <-
  Nothing1234656()

-----------------------------------------
-- not recursive
b442 :: [] >>= [Maybe1142834]
b442[] =
  return s31

-----------------------------------------
-- not recursive
b1427 :: [Bit 32, Bit 32, Bit 32] >>= [Maybe1142834]
b1427[t0, t1, t2] =
  t3 <- add((t1, t2))
  t4 <- add((t0, -1))
  t5 <- Pair0254858(t1, t4, t3)
  Just2244757(t5)

-----------------------------------------
-- not recursive
b479 :: [Bit 32, Bit 32, Bit 32] >>= [Maybe1142834]
b479[t0, t1, t2] =
  t3 <- primEq((t0, 0))
  if t3
    then b442[]
    else b1427[t0, t1, t2]

-----------------------------------------
-- recursive
b1537 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Maybe1142834]
b1537[t0, t1, t2, t3] =
  t4 <- primEq((t0, 0))
  if t4
    then b442[]
    else b1539[t0, t1, t2, t3]
b1539 :: [Bit 32, Bit 32, Bit 32, Bit 32] >>= [Maybe1142834]
b1539[t0, t1, t2, t3] =
  t4 <- add((t1, t2))
  t5 <- add((t0, -1))
  t6 <- add((t3, -1))
  b1171[t5, t4, t6]
b1171 :: [Bit 32, Bit 32, Bit 32] >>= [Maybe1142834]
b1171[t0, t1, t2] =
  t3 <- primEq((t2, 0))
  if t3
    then b479[t0, t1, 12]
    else b1537[t0, t1, 12, t2]

-----------------------------------------
-- not recursive
str1 :: Bit 32
str1 <- "Did not find first user program\n"

-----------------------------------------
-- not recursive
str7 :: Bit 32
str7 <- "\nHalting kernel, returning to mimgload\n"

-----------------------------------------
-- not recursive
b837 :: [] >>= [Unit]
b837[] =
  t0 <- b1519[str1, console]
  t1 <- load8((str7))
  t2 <- primEq((t1, 0))
  if t2
    then b300[]
    else b1521[t1, str7, console]

-----------------------------------------
-- not recursive
str2 :: Bit 32
str2 <- "Found header for first user program:\n"

-----------------------------------------
-- not recursive
str3 :: Bit 32
str3 <- "\n"

-----------------------------------------
-- not recursive
str5 :: Bit 32
str5 <- "Found header for second user program:\n"

-----------------------------------------
-- not recursive
str6 :: Bit 32
str6 <- "\n"

-----------------------------------------
-- not recursive
str8 :: Bit 32
str8 <- "user code is at 0x"

-----------------------------------------
-- not recursive
str9 :: Bit 32
str9 <- "\n"

-----------------------------------------
-- not recursive
b1544 :: [Bit 32, Bit 32, Bit 32, Pair0152935] >>= [Unit]
b1544[t0, t1, t2, t3] =
  t4 <- b1519[str5, console]
  t5 <- b465[t1]
  t6 <- b1519[str6, console]
  t7 <- Pair0254858 0 t3
  t8 <- add((t7, 8))
  t9 <- load32((t8))
  t10 <- b1519[str8, console]
  t11 <- and((t9, 15))
  t12 <- b237[t11]
  t13 <- store8((itoaBuf, t12))
  t14 <- b1692[1, 0, 31, t9, console, 32]
  t15 <- b1519[str9, console]
  t16 <- add((users, 52))
  t17 <- store32((t16, t9))
  t18 <- add((t1, 8))
  t19 <- load32((t18))
  t20 <- b1519[str8, console]
  t21 <- and((t19, 15))
  t22 <- b237[t21]
  t23 <- store8((itoaBuf, t22))
  t24 <- b1692[1, 0, 31, t19, console, 32]
  t25 <- b1519[str9, console]
  t26 <- add((users, 124))
  t27 <- store32((t26, t19))
  t28 <- store1((current, flag0))
  t29 <- outb((32, 17))
  t30 <- outb((33, 32))
  t31 <- outb((33, 4))
  t32 <- outb((33, 1))
  t33 <- outb((33, 251))
  t34 <- outb((160, 17))
  t35 <- outb((161, 40))
  t36 <- outb((161, 2))
  t37 <- outb((161, 1))
  t38 <- outb((161, 255))
  t39 <- outb((67, 52))
  t40 <- outb((64, 156))
  t41 <- outb((64, 46))
  t42 <- inb((33))
  t43 <- and((t42, -2))
  t44 <- outb((33, t43))
  t45 <- load1((current))
  t46 <- flagToWord((t45))
  t47 <- mul((t46, 72))
  t48 <- add((users, t47))
  t49 <- returnTo((t48))
  t50 <- load8((str7))
  t51 <- primEq((t50, 0))
  if t51
    then b300[]
    else b1521[t50, str7, console]

-----------------------------------------
-- not recursive
str4 :: Bit 32
str4 <- "Did not find second user program\n"

-----------------------------------------
-- not recursive
b835 :: [] >>= [Unit]
b835[] =
  t0 <- b1519[str4, console]
  t1 <- load8((str7))
  t2 <- primEq((t1, 0))
  if t2
    then b300[]
    else b1521[t1, str7, console]

-----------------------------------------
-- not recursive
b1462 :: [Maybe1142834] >>= [Unit]
b1462[t0] =
  assert t0 Just2244757
  t1 <- Just2244757 0 t0
  t2 <- b1519[str2, console]
  t3 <- Pair0254858 0 t1
  t4 <- b465[t3]
  t5 <- b1519[str3, console]
  t6 <- Pair0254858 1 t1
  t7 <- Pair0254858 2 t1
  t8 <- primEq((t6, 0))
  if t8
    then b835[]
    else b1544[t6, t7, 12, t1]

-----------------------------------------
-- not recursive
b1635 :: [] >>= [Unit]
b1635[] =
  t0 <- b1519[str50, console]
  t1 <- load32((4104))
  t2 <- b1519[str53, console]
  t3 <- b1519[str51, console]
  t4 <- b1519[str54, console]
  t5 <- b1519[t1, console]
  t6 <- b1519[str55, console]
  t7 <- and((t1, 15))
  t8 <- b237[t7]
  t9 <- store8((itoaBuf, t8))
  t10 <- b1692[1, 0, 31, t1, console, 32]
  t11 <- b1519[str56, console]
  t12 <- load32((4108))
  t13 <- b1519[str53, console]
  t14 <- b1519[str52, console]
  t15 <- b1519[str54, console]
  t16 <- b1519[t12, console]
  t17 <- b1519[str55, console]
  t18 <- and((t12, 15))
  t19 <- b237[t18]
  t20 <- store8((itoaBuf, t19))
  t21 <- b1692[1, 0, 31, t12, console, 32]
  t22 <- b1519[str56, console]
  t23 <- load32((4096))
  t24 <- load32((t23))
  t25 <- add((t23, 4))
  t26 <- b1171[t24, t25, 2]
  case t26 of
    Nothing1234656 -> b837[]
    Just2244757 -> b1462[t26]

-----------------------------------------
-- recursive
b1745 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1745[t0, t1, t2, t3, t4] =
  t5 <- add((t1, t2))
  t6 <- add((t0, -1))
  t7 <- b1519[str36, console]
  t8 <- b1519[t3, console]
  t9 <- b1519[str37, console]
  t10 <- nzrem((t4, 10))
  t11 <- b237[t10]
  t12 <- store8((itoaBuf, t11))
  t13 <- b1739[1, 0, 31, t4, console, 32]
  t14 <- b1519[str38, console]
  t15 <- b1519[str43, console]
  t16 <- load32((t1))
  t17 <- and((t16, 15))
  t18 <- b237[t17]
  t19 <- store8((itoaBuf, t18))
  t20 <- b1692[1, 0, 31, t16, console, 32]
  t21 <- b1519[str44, console]
  t22 <- add((t1, 4))
  t23 <- load32((t22))
  t24 <- and((t23, 15))
  t25 <- b237[t24]
  t26 <- store8((itoaBuf, t25))
  t27 <- b1692[1, 0, 31, t23, console, 32]
  t28 <- b1519[str45, console]
  t29 <- b1519[str39, console]
  t30 <- add((t4, 1))
  t31 <- primEq((t6, 0))
  if t31
    then b1635[]
    else b1745[t6, t5, 8, t3, t30]

-----------------------------------------
-- not recursive
str49 :: Bit 32
str49 <- "mmap"

-----------------------------------------
-- not recursive
b1639 :: [] >>= [Unit]
b1639[] =
  t0 <- b1519[str48, console]
  t1 <- load32((4100))
  t2 <- load32((t1))
  t3 <- add((t1, 4))
  t4 <- primEq((t2, 0))
  if t4
    then b1635[]
    else b1745[t2, t3, 8, str49, 0]

-----------------------------------------
-- recursive
b1748 :: [Bit 32, Bit 32, Bit 32, Bit 32, Bit 32] >>= [Unit]
b1748[t0, t1, t2, t3, t4] =
  t5 <- add((t1, t2))
  t6 <- add((t0, -1))
  t7 <- b1519[str36, console]
  t8 <- b1519[t3, console]
  t9 <- b1519[str37, console]
  t10 <- nzrem((t4, 10))
  t11 <- b237[t10]
  t12 <- store8((itoaBuf, t11))
  t13 <- b1739[1, 0, 31, t4, console, 32]
  t14 <- b1519[str38, console]
  t15 <- b465[t1]
  t16 <- b1519[str39, console]
  t17 <- add((t4, 1))
  t18 <- primEq((t6, 0))
  if t18
    then b1639[]
    else b1748[t6, t5, 12, t3, t17]

-----------------------------------------
-- not recursive
str47 :: Bit 32
str47 <- "header"

-----------------------------------------
-- not recursive
initialize :: [] >>= [Unit]
initialize[] =
  t0 <- store1((current, flag0))
  t1 <- store32((users, 0))
  t2 <- add((users, 4))
  t3 <- store32((t2, 0))
  t4 <- add((users, 8))
  t5 <- store32((t4, 0))
  t6 <- add((users, 12))
  t7 <- store32((t6, 0))
  t8 <- add((users, 16))
  t9 <- store32((t8, 0))
  t10 <- add((users, 20))
  t11 <- store32((t10, 0))
  t12 <- add((users, 24))
  t13 <- store32((t12, 0))
  t14 <- add((users, 28))
  t15 <- store32((t14, 0))
  t16 <- add((users, 32))
  t17 <- store32((t16, 59))
  t18 <- add((users, 36))
  t19 <- store32((t18, 59))
  t20 <- add((users, 40))
  t21 <- store32((t20, 59))
  t22 <- add((users, 44))
  t23 <- store32((t22, 59))
  t24 <- add((users, 48))
  t25 <- store32((t24, 0))
  t26 <- add((users, 52))
  t27 <- store32((t26, 0))
  t28 <- add((users, 56))
  t29 <- store32((t28, 51))
  t30 <- add((users, 60))
  t31 <- store32((t30, 12802))
  t32 <- add((users, 64))
  t33 <- store32((t32, 0))
  t34 <- add((users, 68))
  t35 <- store32((t34, 59))
  t36 <- add((users, 72))
  t37 <- store32((t36, 0))
  t38 <- add((users, 76))
  t39 <- store32((t38, 0))
  t40 <- add((users, 80))
  t41 <- store32((t40, 0))
  t42 <- add((users, 84))
  t43 <- store32((t42, 0))
  t44 <- add((users, 88))
  t45 <- store32((t44, 0))
  t46 <- add((users, 92))
  t47 <- store32((t46, 0))
  t48 <- add((users, 96))
  t49 <- store32((t48, 0))
  t50 <- add((users, 100))
  t51 <- store32((t50, 0))
  t52 <- add((users, 104))
  t53 <- store32((t52, 59))
  t54 <- add((users, 108))
  t55 <- store32((t54, 59))
  t56 <- add((users, 112))
  t57 <- store32((t56, 59))
  t58 <- add((users, 116))
  t59 <- store32((t58, 59))
  t60 <- add((users, 120))
  t61 <- store32((t60, 0))
  t62 <- add((users, 124))
  t63 <- store32((t62, 0))
  t64 <- add((users, 128))
  t65 <- store32((t64, 51))
  t66 <- add((users, 132))
  t67 <- store32((t66, 12802))
  t68 <- add((users, 136))
  t69 <- store32((t68, 0))
  t70 <- add((users, 140))
  t71 <- store32((t70, 59))
  t72 <- store8((console, 0))
  t73 <- add((console, 1))
  t74 <- store8((t73, 0))
  t75 <- add((console, 2))
  t76 <- store8((t75, 24))
  t77 <- add((console, 3))
  t78 <- store8((t77, 79))
  t79 <- add((console, 4))
  t80 <- store8((t79, 0))
  t81 <- add((console, 5))
  t82 <- store8((t81, 0))
  t83 <- add((console, 6))
  t84 <- store8((t83, 10))
  t85 <- store32((ticks, 1))
  t86 <- store8((pos, 55))
  t87 <- store1((dir, flag1))
  t88 <- store8((spinner, 45))
  t89 <- add((spinner, 1))
  t90 <- store8((t89, 92))
  t91 <- add((spinner, 2))
  t92 <- store8((t91, 124))
  t93 <- add((spinner, 3))
  t94 <- store8((t93, 47))
  t95 <- store8((spinpos, 0))
  t96 <- b1467[itoaBuf, 0]
  t97 <- store8((t83, 32))
  t98 <- load8((console))
  t99 <- load8((t73))
  t100 <- store8((t79, t98))
  t101 <- store8((t81, t99))
  t102 <- load8((t75))
  t103 <- load8((t77))
  t104 <- load8((t83))
  t105 <- b1095[t98, t102, t104, t103, t99]
  t106 <- b1519[str0, console]
  t107 <- store8((console, 1))
  t108 <- store8((t73, 1))
  t109 <- store8((t75, 23))
  t110 <- store8((t77, 45))
  t111 <- store8((t79, 1))
  t112 <- store8((t81, 1))
  t113 <- store8((t83, 15))
  t114 <- load8((console))
  t115 <- load8((t73))
  t116 <- store8((t79, t114))
  t117 <- store8((t81, t115))
  t118 <- load8((t75))
  t119 <- load8((t77))
  t120 <- load8((t83))
  t121 <- b1095[t114, t118, t120, t119, t115]
  t122 <- b1519[str46, console]
  t123 <- load32((4096))
  t124 <- load32((t123))
  t125 <- add((t123, 4))
  t126 <- primEq((t124, 0))
  if t126
    then b1639[]
    else b1748[t124, t125, 12, str47, 0]

-----------------------------------------
-- Entrypoints: yield kputc timerInterrupt unhandled
